# Ops Team Access Scenario â€“ IAM Permissions

---

## Scenario Overview

We have an Ops team with **10 members**.  
All team members are mapped to the same permission group, which provides **full access to EC2 and S3**.

Recently, a new team member named **Sunil** joined the Ops team.

- Sunil is **very experienced with EC2**
- He **does not have experience with S3**
- He is a **contract employee**

Our S3 buckets contain many objects, including **confidential information**.  
For security reasons, we do **not want Sunil to have access to S3**, even though he is mapped to the Ops team.

---

## âœ… Requirement

**Sunil should have only EC2 access and no S3 access**,  
even though the Ops team has permissions for both EC2 and S3.

---

## â“ Question

Is it possible to **remove or restrict S3 access for Sunil only**,  
while keeping EC2 access, even though he is part of the Ops team?

---

## âœï¸ Important Point

When we check **AWS managed policies**, there is **no policy available to deny S3 access**.

AWS does **not provide a default S3 deny policy**,  
so we need to create a **custom IAM policy** to explicitly deny S3 access.

---

## ğŸ”µ In AWS IAM â€“ Policies

---

## ğŸ› ï¸ Steps to Create S3 Deny Policy

1. Go to **IAM â†’ Policies**
2. Click **Create policy**
3. Choose a service â†’ search for **S3**
4. Under **Effect**, select **Deny**
5. In **Actions**
   - Choose **Manual actions**
   - Select **All S3 actions**
6. In **Resources**, select **All resources**
7. Click **Next**
8. Enter:
   - **Policy Name:** `S3-deny`
   - **Description:** This policy will deny all S3 operations
9. Click **Create policy**

---

## âš ï¸ Important Note

Creating the policy **does not automatically attach it**  
to any user or group.

---

## ğŸ› ï¸ Steps to Attach Policy to Sunil

1. Go to **IAM â†’ Users**
2. Select **Sunil**
3. Click **Add permissions**
4. Choose **Attach policies directly**
5. Search for **S3-deny**
6. Attach the policy

---

## ğŸ“Œ IAM Concept / Rule

**Deny always has the highest priority in AWS IAM.**

For a user or group, if a service has both **Allow** and **Deny** permissions  
(for example: S3, EC2, VPC, RDS, IAM, etc.):

- âœ… **Deny overrides all Allow permissions**
- Even if permissions are given at:
  - Group level
  - User level
  - Administrator level

Once **Deny** is applied, access is blocked.

---

## ğŸ”µ Use Case

---

## ğŸ§¾ Explanation

Sometimes we may receive a ticket like:

> â€œI have full access to an S3 bucket, but I am not able to upload an object.â€

In such cases, we must check whether a **Deny permission** is assigned to the user.

---

## ğŸ” Verification Steps

- Open the **Sunil** user in IAM
- He has:
  - EC2â€“S3 full access (via group)
  - `S3-deny` policy (directly attached)
- Because of the **S3-deny** policy:
  - Sunil **cannot access S3**
- The deny policy is attached at the **user level**, not group level
- Log in using Sunilâ€™s credentials in another browser
- Attempt to access S3 â†’ âŒ **Access denied**

---

## ğŸŸ¢ Final Conclusion

- **Deny has the highest priority** over Allow
- Even if **AdministratorAccess** is granted,
  **Sunil will still not be able to access S3**
